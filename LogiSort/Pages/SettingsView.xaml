<UserControl x:Class="LogiSort.Pages.SettingsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             xmlns:local="clr-namespace:LogiSort.Pages"
             mc:Ignorable="d" 
             Background="{DynamicResource MaterialDesignPaper}">

    <UserControl.Resources>
        <!-- Универсальный стиль для секций -->
        

        <!-- Нижняя панель -->
        <Style x:Key="BottomBarStyle" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource MaterialDesignPaper}" />
            <Setter Property="Padding" Value="12"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
    </UserControl.Resources>

    <Grid>
        <!-- Масштабирование всего интерфейса -->
        <Grid.LayoutTransform>
            <ScaleTransform ScaleX="{Binding SelectedScale}" ScaleY="{Binding SelectedScale}" />
        </Grid.LayoutTransform>

        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Основной скролл -->
        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20">

                <!-- Заголовок -->
                <materialDesign:ColorZone Mode="PrimaryDark" Padding="12">
                    <DockPanel>
                        <materialDesign:PackIcon Kind="Settings"
                                                 Width="28" Height="28"
                                                 Margin="0,0,10,0"
                                                 Foreground="White"/>
                        <TextBlock Text="{Binding LanguageService.Page_Title_Settings}"
                                   FontSize="22" FontWeight="Bold"
                                   Foreground="White"
                                   VerticalAlignment="Center"/>
                    </DockPanel>
                </materialDesign:ColorZone>

                <!-- ============ БЛОК: Интерфейс ============ -->
                <!--Нужна заглавная надпись перед блоком-->
                <Border Style="{StaticResource SectionBorderStyle}">
                    <StackPanel>
                        <TextBlock Text="{Binding LanguageService.SettInterface}" 
                                   FontSize="18" FontWeight="Bold" Margin="0,0,0,12"/>
                        <!-- Язык -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="{Binding LanguageService.SettingsLanguage}" 
                                       FontSize="16" FontWeight="SemiBold" Margin="0,0,0,6"/>
                            <ComboBox Width="200"
                                      ItemsSource="{Binding LanguageService.AvailableLanguages}"
                                      DisplayMemberPath="Name"
                                      SelectedValuePath="Code"
                                      SelectedValue="{Binding SelectedLanguage, Mode=TwoWay}"
                                      materialDesign:HintAssist.Hint="{Binding LanguageService.SettSelectLang}"
                                      HorizontalAlignment="Left"/>
                        </StackPanel>
                         
                        <!-- Тема -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="{Binding LanguageService.SettTopic}" FontSize="16" FontWeight="Bold" Margin="0,0,0,10"/>
                            <ComboBox ItemsSource="{Binding AvailableThemesLocalized}" SelectedItem="{Binding SelectedThemeItem, Mode=TwoWay}" 
                                      DisplayMemberPath="DisplayName" Width="200" HorizontalAlignment="Left"/>
                        </StackPanel>
                           
                        <!-- Масштаб -->
                        <StackPanel>
                            <TextBlock Text="{Binding LanguageService.SettFont}" 
                                       FontSize="16" FontWeight="SemiBold" Margin="0,0,0,6"/>
                            <ComboBox ItemsSource="{Binding AvailableScales}" 
                                      SelectedItem="{Binding SelectedScale, Mode=TwoWay}" 
                                      Width="200"
                                      HorizontalAlignment="Left">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding StringFormat={}{0:P0}}" />
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- ============ БЛОК:2 -->
                <Border Style="{StaticResource SectionBorderStyle}">
                    <StackPanel>
                        <TextBlock Text="{Binding LanguageService.SettSystem}" 
                                   FontSize="18" FontWeight="Bold" Margin="0,0,0,12"/>

                        <!-- Уведомления -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="{Binding LanguageService.SettNotifications}" 
                                       FontSize="16" FontWeight="SemiBold" Margin="0,0,0,6"/>
                            <CheckBox Content="{Binding LanguageService.SettSound}" 
                                      IsChecked="{Binding Notifications.SoundEnabled, Mode=TwoWay}" />
                            <CheckBox Content="{Binding LanguageService.SettVisual}" 
                                      IsChecked="{Binding Notifications.VisualEnabled, Mode=TwoWay}" />
                            <ComboBox Width="200"
                                      ItemsSource="{Binding Notifications.ImportanceLevels}"
                                      SelectedItem="{Binding Notifications.SelectedImportance, Mode=TwoWay}"
                                      DisplayMemberPath="Name"
                                      HorizontalAlignment="Left"/>
                        </StackPanel>

                        <!-- Обновления -->
                        <StackPanel Margin="0,0,0,12">
                            <TextBlock Text="{Binding LanguageService.SettUpdates}" 
                                       FontSize="16" FontWeight="SemiBold" Margin="0,0,0,6"/>
                            <CheckBox Content="{Binding LanguageService.SettAutomatic_updates}" 
                                      IsChecked="{Binding AutoUpdateEnabled, Mode=TwoWay}" />
                            <Button Content="{Binding LanguageService.SettCheck_for_updates}" 
                                    Command="{Binding CheckForUpdatesCommand}" 
                                    Style="{StaticResource MaterialDesignOutlinedButton}" 
                                    Width="180"
                                    HorizontalAlignment="Left"/>
                        </StackPanel>

                        <!-- Логирование -->
                        <StackPanel>
                            <TextBlock Text="{Binding LanguageService.SettLogging}" 
                                       FontSize="16" FontWeight="SemiBold" Margin="0,0,0,6"/>
                            <CheckBox Content="{Binding LanguageService.SettEnable_logging}" 
                                      IsChecked="{Binding LoggingEnabled, Mode=TwoWay}" />
                            <Button Content="{Binding LanguageService.SettOpen_log}" 
                                    Command="{Binding OpenLogCommand}" 
                                    Style="{StaticResource MaterialDesignOutlinedButton}" 
                                    Width="160"
                                    Cursor="Hand"
                                    HorizontalAlignment="Left"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- ============ БЛОК: Хз ============ -->
                <Border Style="{StaticResource SectionBorderStyle}">
                    <StackPanel>
                        <TextBlock Text="{Binding LanguageService.SettAccount}" 
                                   FontSize="18" FontWeight="Bold" Margin="0,0,0,12"/>
                        <Button Content="{Binding LanguageService.SettLogin}" 
                                Command="{Binding LoginCommand}" 
                                Style="{StaticResource MaterialDesignOutlinedButton}" 
                                Width="160"
                                HorizontalAlignment="Left"
                                Cursor="Hand"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Нижняя панель -->
        <Border Grid.Row="1" Style="{StaticResource BottomBarStyle}">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="{Binding LanguageService.SettCancel}" 
                        Command="{Binding CancelChangesCommand}" 
                        Style="{StaticResource MaterialDesignFlatButton}" Margin="0,0,8,0"/>
                <Button Content="{Binding LanguageService.SettReset_settings}" 
                        Command="{Binding ResetToDefaultsCommand}" 
                        Style="{StaticResource MaterialDesignFlatButton}" Margin="0,0,8,0"/>
                <Button Content="{Binding LanguageService.SettSave}" 
                        Command="{Binding ApplySettingsCommand}" 
                        Style="{StaticResource MaterialDesignRaisedButton}" Cursor="Hand"/>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>